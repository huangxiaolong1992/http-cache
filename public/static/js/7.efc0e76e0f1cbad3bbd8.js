webpackJsonp([7],{PzF3:function(t,e){},aoIN:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAABVCAYAAAA49ahaAAAABHNCSVQICAgIfAhkiAAAAeJJREFUeJzt3MFOGlEUgOFzCfv6BrptLNENJOJCH6VvUnwT36S4UJKywASNy/oKJk1KAuV0xQ6mtrk/WPy/7U1mbv7MBCacodyNHzJUTUZetXa9iX1kVIBRAUYFGBVgVEC7abHf/VS2tZH/ye14OihRvmxa90oFGBVgVIBRAUYFGBVgVIBRAUYFND5R7dJk8v3g53x2sm4tY/ly3ju+3/aeXuvNRp0tfpxGKV/XrZXIm4i43PKWXs3bH2BUgFEBRgUYFWBUgFEBRgUYFWBUgFEBRgUYFWBUgFEBRgUYFWBUgFEBVX6jGk2ejnIehzWOtZK5OIkNg5yZ5cPdt6eLmueLiOj3Pt7UOE6VqMvF4nMpm+c1/83m0dhS4jTi17Du+f5w0r/g7Q8wKsCoAKMCjAqo8unfytZzlmWVryMrmeWglFg7SxWRLxGx37NUZ73j64i4rnGsldF4epmxfpYqIu773Y6zVO+JUQFGBRgVYFSAUQFGBRgVYFSAUQFGBRgVYFSAUQFGBRgVYFSAUQFGBRgV8Gb/ROGs2xlGpdmmbfNKBRgVYFSAUQFGBRgVYFSAUQFGBTQ+UY3Gj5XfONkPGdn4ulFj1Iwc1N3O++DtDzAqwKgAowKMCmhn5NWuN7FPWhHD39wSS+5bKqkAAAAAAElFTkSuQmCC"},dWWc:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("4YfN"),a=i.n(s),n=i("2bvH"),c={name:"activeDirectory",data:function(){return{titleName:this.$route.query.title,activeNames:"",activeNums:0,valueTime:[],ipVoteAstrict:"",editorData:[{title:"",weight:"",item_id:"",image:""}],activeData:{},vote_id:""}},watch:{ipVoteAstrict:function(t){""==t||this.IsInteger(Number(t))||this.$message({message:"请输入正确的整数值!",type:"warning"})},editorData:{handler:function(t){for(var e=0;e<t.length;e++)this.JudgeIsNaN(Number(t[e].weight))?parseFloat(t[e].weight)>99&&this.$message({message:"权重值不能大于99!",type:"warning"}):this.$message({message:"请输入正确的权重值!",type:"warning"})},deep:!0},activeNames:function(t){this.activeNums=t.length}},computed:a()({},Object(n.c)({userInfo:function(t){return t.mutations.userInfo}})),created:function(){if("编辑活动"==this.titleName){var t=this.$route.query.activeData;this.activeData=t,this.activeNames=t.activityName,this.valueTime=[t.startDate,t.endDate],this.GetVoteList(t.activityId)}this.verifyToken()},methods:{verifyToken:function(){var t=this,e=localStorage.getItem("accessToken");if(e){var i=this.api.configIp+this.net.verifyToken,s={accessToken:e};this.$fetch(i,s).then(function(e){console.log("sucess:",e),e.success||(t.$message.warning("登录已经超时,需重新登陆"),setTimeout(function(){t.$router.push({name:"login"})},2e3))}).catch(function(t){console.log("err:",t)})}},IsInteger:function(t){return"number"==typeof t&&t%1==0&&t>0},goBack:function(){this.$router.back(-1)},selectTime:function(t){console.log("选择时间:",t),this.valueTime=t},JudgeIsNaN:function(t){return"number"==typeof t&&!isNaN(t)},GetVoteList:function(t){var e=this,i=this.api.voteUrl+this.net.activityBlogList,s={activity_id:t};this.$post(i,s).then(function(t){console.log("sucess:",t),200==t.code&&(e.editorData=t.data.items,e.ipVoteAstrict=t.data.limit_vote_num,e.vote_id=t.data.vote_id)}).catch(function(t){console.log("err:",t)})},SaveActivity:function(){var t=this,e=this.url+this.net.saveActivity,i=this.activeNames,s=this.valueTime,a=this.userInfo.id,n=(new Date).getTime();if(""!=i)if(s[0])if(s[1]<n)this.$message({message:"截止日期不能小于当前时间",type:"warning"});else{var c={activityName:i,endDate:s[1],startDate:s[0],createUser:a,ipVoteAstrict:this.ipVoteAstrict};this.$post(e,c).then(function(e){200==e.code&&(t.saveVote(e.data),t.vote_id="")}).catch(function(t){console.log("err:",t)})}else this.$message({message:"请选择时间",type:"warning"});else this.$message({message:"请填写活动名称",type:"warning"})},saveVote:function(t){var e=this,i=this.api.voteUrl+this.net.saveVote,s={vote_id:this.vote_id,activity_id:t,title:this.activeNames,deadline:this.getdate(this.valueTime[1]),items:this.editorData,limit_vote_num:this.ipVoteAstrict};this.$post(i,s).then(function(t){200==t.code?(e.$message({message:"保存成功",type:"success"}),e.clearData(),e.$router.back(-1)):e.$message.error("保存失败!")}).catch(function(t){console.log("err:",t)})},EditActivity:function(){var t=this,e=this.url+this.net.editActivity,i=this.activeNames,s=this.valueTime,a=this.userInfo.id,n=(new Date).getTime();if(""!=i)if(s[0])if(s[1]<n)this.$message({message:"截止日期不能小于当前时间",type:"warning"});else{var c={activityId:this.activeData.activityId,activityName:i,endDate:s[1],startDate:s[0],createUser:a,ipVoteAstrict:this.ipVoteAstrict};this.$post(e,c).then(function(e){console.log("sucess:",e),200==e.code&&t.saveVote(t.activeData.activityId)}).catch(function(t){console.log("err:",t)})}else this.$message({message:"请选择时间",type:"warning"});else this.$message({message:"请填写活动名称",type:"warning"})},addOptions:function(){"添加活动"==this.titleName?this.editorData.push({title:"",weight:"",item_id:"",image:""}):this.editorData.push({item_id:"",vote_id:this.vote_id,title:"",image:"",vote_num:0,weight:"",is_delete:0})},deleteOption:function(t){var e=this;this.editorData.forEach(function(i,s){t==s&&e.editorData.splice(s,1)})},clearData:function(){this.activeNames="",this.ipVoteAstrict="",this.valueTime=[],this.editorData=[{title:"",weight:"",item_id:"",image:""}]}},components:{}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"activeAdd"},[s("div",{staticClass:"container"},[s("div",{staticClass:"activeTitle"},[s("span",{staticClass:"back",on:{click:t.goBack}},[t._v("活动列表")]),t._v(" "),s("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),s("span",[t._v(t._s(t.titleName))])]),t._v(" "),s("div",{staticClass:"activeContent"},[s("div",{staticClass:"baseInfo"},[t._v("\n          基本信息\n        ")]),t._v(" "),s("div",{staticClass:"activeName"},[t._v("\n          活动名称\n          "),s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容",onfocus:"this.placeholder=''",onblur:"this.placeholder='请输入内容'",maxlength:30},model:{value:t.activeNames,callback:function(e){t.activeNames="string"==typeof e?e.trim():e},expression:"activeNames"}}),t._v(" "),s("span",{staticClass:"wordNums"},[t._v(t._s(t.activeNums)+"/30")])],1),t._v(" "),s("div",{staticClass:"activeTime"},[t._v("\n          活动时间\n            "),s("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","value-format":"timestamp","end-placeholder":"结束日期"},on:{change:t.selectTime},model:{value:t.valueTime,callback:function(e){t.valueTime=e},expression:"valueTime"}})],1),t._v(" "),s("div",{staticClass:"voteTimes"},[s("div",{staticClass:"sign"},[t._v("\n            同IP投票有效次数\n          ")]),t._v(" "),s("div",{staticClass:"times"},[s("el-input",{attrs:{placeholder:"1~99",maxlength:2,onfocus:"this.placeholder=''",onblur:"this.placeholder='1~99'"},model:{value:t.ipVoteAstrict,callback:function(e){t.ipVoteAstrict=e},expression:"ipVoteAstrict"}}),t._v(" "),s("span",[t._v("次/天(0~24时)")])],1)]),t._v(" "),s("div",{staticClass:"voteSetting"},[s("div",{staticClass:"sign"},[t._v("\n            投票设置\n          ")]),t._v(" "),s("div",{staticClass:"voteList"},[s("ul",{staticClass:"clearfix"},[t._l(t.editorData,function(e,i){return s("li",{key:i,staticClass:"Item"},[s("div",{staticClass:"voteNames"},[s("p",[t._v("评价内容")]),t._v(" "),s("div",{staticClass:"textArea"},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"例:评论1",maxlength:30,onfocus:"this.placeholder=''",onblur:"this.placeholder='例:评论1'"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}})],1)]),t._v(" "),s("div",{staticClass:"voteStatus"},[s("p",[t._v("权重")]),t._v(" "),s("div",{staticClass:"votePercent"},[s("el-input",{attrs:{placeholder:"0~99",maxlength:5,onfocus:"this.placeholder=''",onblur:"this.placeholder='0~99'"},model:{value:e.weight,callback:function(i){t.$set(e,"weight",i)},expression:"item.weight"}}),t._v(" "),s("span",{staticClass:"intro"},[t._v("权重影响该评分在总评分中的重要性")])],1)]),t._v(" "),s("div",{staticClass:"closeBtn",on:{click:function(e){return t.deleteOption(i)}}},[s("i",{staticClass:"el-icon-close"})])])}),t._v(" "),s("li",{staticClass:"addItem",on:{click:t.addOptions}},[s("img",{attrs:{src:i("aoIN")}})])],2)])]),t._v(" "),s("div",{staticClass:"clearBtn",on:{click:t.clearData}},[t._v("\n          清除\n        ")])]),t._v(" "),"添加活动"==t.titleName?s("div",{staticClass:"confirmBtn",on:{click:t.SaveActivity}},[t._v("\n        确认添加\n      ")]):s("div",{staticClass:"confirmBtn",on:{click:t.EditActivity}},[t._v("\n        确认修改\n      ")])])])},staticRenderFns:[]};var l=i("C7Lr")(c,o,!1,function(t){i("PzF3")},"data-v-c2bd57d0",null);e.default=l.exports}});
//# sourceMappingURL=7.efc0e76e0f1cbad3bbd8.js.map