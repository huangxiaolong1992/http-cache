webpackJsonp([13],{"8iBR":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("IHPB"),i=a.n(s),l=a("hRKE"),n=a.n(l),o=a("4YfN"),r=a.n(o),c=a("2bvH"),u={data:function(){return{cityDefault:"",options1:[{value1:-1,label1:"不限"},{value1:0,label1:"草稿"},{value1:1,label1:"未审核"},{value1:2,label1:"被通过"},{value1:3,label1:"被驳回"}],value1:"不限",options:[{value:[],label:"不限",children:[{value:[],label:"不限"}]}],value:"",options2:[{value2:-1,label2:"不限"},{value2:1,label2:"自主研发"},{value2:2,label2:"合作研发"},{value2:3,label2:"企业研发"}],value2:"不限",value3:[],search:"",undercarriageMask:!1,optionArr:[],total:0,noData:!1,blogId:"",state:0,pageNum:1,dialogVisible:!1,radio2:"涉及敏感内容",anothorResultInput:"",rejectInfo:"",clearable:!0,selectTypeVal:""}},computed:r()({},Object(c.c)({userInfo:function(e){return e.mutations.userInfo}})),created:function(){this.updateToken(),this.getCategory()},methods:{judegeIsAdmin:function(){2==this.userInfo.type?(this.cityDefault=this.userInfo.district,console.log("变更省份1:",this.cityDefault),this.getAuditBlog()):this.getAuditBlog()},updateToken:function(){var e=this,t=localStorage.getItem("accessToken");if(t){var a=this.api.configIp+this.net.updateToken,s={accessToken:t};this.$fetch(a,s).then(function(t){console.log("sucess:",n()(t.data)),t.success?(e.$store.commit("saveUserInfo",JSON.parse(t.data)),e.judegeIsAdmin()):e.judegeIsAdmin()}).catch(function(e){console.log("err:",e)})}},details:function(e){this.$router.push({path:"/achievementAudit/details",query:{blogId:e}})},undercarriage:function(e,t){this.blogId=e,this.state=t,this.undercarriageMask=!0},close:function(){this.undercarriageMask=!1},getAuditBlog:function(e,t,a,s,i,l){var n=this,o=l||1;"string"!=typeof e&&-1!=e||(e=""),t||(t=["",""]),""==t.join("")&&(t=["",""]),"string"!=typeof a&&-1!=a||(a=""),s||(s=["",""]);var r={auditTerminal:"1",pageNum:o,pageSize:10,auditState:e,tagTypeId1:t[0],tagTypeId2:t[1],msgFrom:a,startDate:s[0],endDate:s[1],blogTitle:i,orderByParam:"{auditState:1}",district:this.cityDefault};this.$post(this.url+"/manage/audit/getAllAuditBlog",r).then(function(e){200==e.code?(n.noData=0==e.data.result.length,n.optionArr=e.data.result,n.total=e.data.total,n.pageNum=e.data.pageNum):n.$message.error("请求失败，请稍后重试")})},selectStatus:function(e){this.getAuditBlog(e,this.value,this.value2,this.value3,this.search)},selectFrom:function(e){this.getAuditBlog(this.value1,this.value,e,this.value3,this.search)},selectTime:function(e){this.getAuditBlog(this.value1,this.value,this.value2,e,this.search)},selectType:function(e){this.selectTypeVal=e,this.getAuditBlog(this.value1,e,this.value2,this.value3,this.search)},inputSearch:function(){this.getAuditBlog(this.value1,this.value,this.value2,this.value3,this.search)},handleClose:function(){this.dialogVisible=!1},passReject:function(e,t){var a=this,s=4==this.radio2?this.anothorResultInput:this.radio2,i=this.userInfo.id,l=void 0;2==t?(s="",l=!0):l=!1;var n={blogId:e,auditUserId:i,auditState:t,rejectInfo:s,isUpperShelf:l};this.$post(this.url+"/manage/audit/auditAch",n).then(function(e){if(200==e.code){var s=3==t?"驳回成功":"审核通过";a.$message({message:s,type:"success"}),a.getAuditBlog(a.value1,a.value,a.value2,a.value3,a.search),a.dialogVisible=!1}else a.$message.error("请求失败，请稍后重试")})},sure:function(){var e=this,t={blogId:this.blogId,isUpperShelf:0!=this.state};this.$post(this.url+"/manage/audit/editShelfAch",t).then(function(t){200==t.code?(e.$message({message:(0==e.state?"下架":"上架")+"成功",type:"success"}),e.undercarriageMask=!1,e.getAuditBlog(e.value1,e.value,e.value2,e.value3,e.search)):e.$message.error("请求失败，请稍后重试")})},deleteAudit:function(e,t,a,s){var i=this,l={blogId:e,isDelete:s};this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.deleteBlog(e,t,a,s,l)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},deleteBlog:function(e,t,a,s,i){var l=this;this.$post(this.url+"/manage/audit/removeAch",i).then(function(s){200==s.code?(l.$message({message:"删除成功",type:"success"}),l.getAuditBlog(l.value1,l.value,l.value2,l.value3,l.search,a)):610==s.code?l.$confirm("该成果正在展示中，是否确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={blogId:e,isDelete:!0};l.deleteBlog(e,t,a,!0,s)}).catch(function(){l.$message({type:"info",message:"已取消删除"})}):l.$message.error("请求失败，请稍后重试")})},clear:function(){this.search="",this.value1=-1,this.value="",this.value2="不限",this.value3="",this.getAuditBlog(this.value1,this.value,this.value2,this.value3,this.search)},rejectReasonMask:function(e){this.dialogVisible=!0,this.blogId=e},getCategory:function(){var e=this;this.$post(this.url+"/manage/category/getAllCategory",{}).then(function(t){if(200==t.code){var a=t.data;e.options=[].concat(i()(e.options),i()(function e(t,a){for(var s=[],i=0;i<t.length;i++){var l=t[i];if(l.parentCategoryId==a){var n={};n.value=l.categoryId,n.label=l.categoryName,s.push(n),0!=e(t,l.categoryId).length&&(n.children=e(t,l.categoryId))}}return s}(a,0)))}else e.$message.error("请求失败，请稍后重试")})},handleCurrentChange:function(e){this.getAuditBlog(this.value1,this.selectTypeVal,this.value2,this.value3,this.search,e)}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"achievementContent"},[e.undercarriageMask?a("div",{staticClass:"undercarriageMask"},[a("div",{staticClass:"undercarriageContent"},[a("p",[e._v("\n          选择对象\n          "),a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.close()}}})]),e._v(" "),a("div",{staticClass:"undercarriageText"},[e._v("\n          确定"+e._s(0==e.state?"下架":"上架")+"该成果发布吗\n        ")]),e._v(" "),a("div",{staticClass:"undercarriageButton"},[a("span",{staticClass:"cancel",on:{click:function(t){return e.close()}}},[e._v("取消")]),e._v(" "),a("span",{staticClass:"sure",on:{click:function(t){return e.sure()}}},[e._v("确定")])])])]):e._e(),e._v(" "),a("div",{staticClass:"achievementTitle"},[e._v("\n  \t  成果审核\n  \t")]),e._v(" "),a("div",{staticClass:"requirement"},[a("span",[e._v("\n        状态\n        "),a("el-select",{staticClass:"selected",attrs:{clearable:e.clearable,placeholder:"请选择"},on:{change:e.selectStatus},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,function(e){return a("el-option",{key:e.value1,attrs:{label:e.label1,value:e.value1}})}),1)],1),e._v(" "),a("span",[e._v("\n        类别\n        "),a("el-cascader",{attrs:{options:e.options,placeholder:"不限"},on:{change:e.selectType,"expand-change":e.selectType},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("span",[e._v("\n        来源\n        "),a("el-select",{staticClass:"selected",attrs:{placeholder:"请选择"},on:{change:e.selectFrom},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,function(e){return a("el-option",{key:e.value2,attrs:{label:e.label2,value:e.value2}})}),1)],1),e._v(" "),a("span",[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","value-format":"timestamp","end-placeholder":"结束日期"},on:{change:e.selectTime},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),e._v(" "),a("span",{staticClass:"search"},[a("i",{staticClass:"el-icon-search"}),e._v(" "),a("el-input",{staticClass:"inputSearch",attrs:{placeholder:"请输入搜索内容"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("el-button",{staticClass:"searchButton",attrs:{type:"primary"},on:{click:e.inputSearch}},[e._v("搜索")])],1),e._v(" "),a("span",{staticClass:"clear",on:{click:e.clear}},[e._v("\n        清除\n      ")])]),e._v(" "),a("div",{staticClass:"searchResult"},[e._m(0),e._v(" "),e.noData?a("div",{staticClass:"noData"},[e._v("\n        暂无数据\n      ")]):e._e(),e._v(" "),a("div",{staticClass:"list"},e._l(e.optionArr,function(t,s){return a("ul",{key:s,staticClass:"tableTr"},[a("li",[a("span",{staticClass:"title"},[e._v(e._s(t.blogTitle))])]),e._v(" "),a("li",[e._v(e._s(t.userNickname))]),e._v(" "),a("li",[e._v(e._s(t.tagTypeName2))]),e._v(" "),a("li",[e._v("\n            "+e._s(1==t.msgFrom?"自主研发":2==t.msgFrom?"合作研发":3==t.msgFrom?"企业研发":"")+"\n          ")]),e._v(" "),a("li",[0==t.auditState?a("span",{staticClass:"draft"},[e._v("\n              草稿\n            ")]):e._e(),e._v(" "),1==t.auditState?a("span",{staticClass:"noExamine"},[e._v("\n              未审核\n            ")]):e._e(),e._v(" "),2==t.auditState?a("span",{staticClass:"passed"},[e._v("\n              被通过\n            ")]):e._e(),e._v(" "),3==t.auditState?a("span",{staticClass:"reject"},[e._v("\n              被驳回\n            ")]):e._e()]),e._v(" "),a("li",[e._v("\n            "+e._s(e.formatDate(t.createTime))+"\n          ")]),e._v(" "),a("li",{staticClass:"operate"},[2!=t.auditState&&3!=t.auditState?a("span",{staticClass:"pass",on:{click:function(a){return e.passReject(t.blogId,2)}}},[e._v("\n              通过\n            ")]):e._e(),e._v(" "),2!=t.auditState&&3!=t.auditState?a("span",{staticClass:"reject",on:{click:function(a){return e.rejectReasonMask(t.blogId)}}},[e._v("\n             驳回\n            ")]):e._e(),e._v(" "),2==t.auditState?a("span",{staticClass:"undercarriage",class:{isundercarriage:1==t.isUpperShelf},on:{click:function(a){return e.undercarriage(t.blogId,0==t.isUpperShelf?1:0)}}},[e._v("\n             "+e._s(0==t.isUpperShelf?"上架":"下架")+"\n            ")]):e._e(),e._v(" "),a("span",{staticClass:"delete",on:{click:function(a){return e.deleteAudit(t.blogId,s,e.pageNum,!1)}}},[e._v("\n             删除\n            ")]),e._v(" "),a("span",{staticClass:"detail",on:{click:function(a){return e.details(t.blogId)}}},[e._v("\n\t        \t\t详情\n\t        \t\t"),a("i",{staticClass:"el-icon-arrow-right"})])])])}),0)]),e._v(" "),a("el-dialog",{attrs:{title:"微科技",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"dialogContent"},[a("p",[e._v("请选择驳回原因")]),e._v(" "),a("div",{staticClass:"rejectReason"},[a("el-radio-group",{model:{value:e.radio2,callback:function(t){e.radio2=t},expression:"radio2"}},[a("el-radio",{attrs:{label:"涉及敏感内容"}},[e._v("涉及敏感内容")]),e._v(" "),a("el-radio",{attrs:{label:"内容描述不清"}},[e._v("内容描述不清")]),e._v(" "),a("el-radio",{attrs:{label:"展示效果不强"}},[e._v("展示效果不强")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("\n              其他\n              "),a("el-input",{staticClass:"anothorResult",attrs:{placeholder:"请输入内容"},model:{value:e.anothorResultInput,callback:function(t){e.anothorResultInput=t},expression:"anothorResultInput"}})],1)],1)],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.passReject(e.blogId,3)}}},[e._v("确 定")])],1)]),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"tableTr"},[a("li",[e._v("成果名称")]),e._v(" "),a("li",[e._v("发布人")]),e._v(" "),a("li",[e._v("类别")]),e._v(" "),a("li",[e._v("来源")]),e._v(" "),a("li",[e._v("状态")]),e._v(" "),a("li",[e._v("发布时间")]),e._v(" "),a("li",{staticClass:"operate"},[e._v("操作")])])}]};var d={data:function(){return{}},components:{achievementContent:a("C7Lr")(u,v,!1,function(e){a("NKs5")},"data-v-35da6744",null).exports}},h={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"achievementAudit"},[t("achievementContent")],1)},staticRenderFns:[]},g=a("C7Lr")(d,h,!1,null,null,null);t.default=g.exports},NKs5:function(e,t){}});
//# sourceMappingURL=13.a2edbdc650f2ab7b991d.js.map