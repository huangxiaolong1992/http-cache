webpackJsonp([11],{"26Ic":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),l=a("Dd8w"),n=a.n(l),r=a("zyNP"),o=a("2bvH"),c={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",number:"",options:[],value:"",value3:[],num1:1,peopleArr:[],selectedPeople:[],isActive:!1,noData1:!0,taskName:"",adcode:"",province:"",zTreeinput:""}},computed:n()({},Object(o.b)({orgId:"orgId"})),watch:{orgId:function(){this.getPeopleList(this.orgId.orgId)}},created:function(){this.getSiteList(),this.initTime()},methods:{initTime:function(){var e=(new Date).getMonth()+1<10?"0"+((new Date).getMonth()+1):(new Date).getMonth()+1,t=(new Date).getFullYear()+"-"+e+"-"+(new Date).getDate();this.value3=[t+" 00:00:00",t+" 23:59:59"]},loadMap:function(e){var t=this;minemap.domainUrl=this.mapUrl,minemap.dataDomainUrl=this.dataDomainUrl,minemap.spriteUrl=this.mapUrl+"/minemapapi/"+this.version+"/sprite/sprite",minemap.serviceUrl=this.mapUrl+"/service",minemap.accessToken="25cc55a69ea7422182d00d6b7c0ffa93",minemap.solution=2365;new minemap.Map({container:"map",style:this.mapUrl+"/service/solu/style/id/2365",center:[121.90154,29.46968],zoom:10,pitch:0,maxZoom:17,minZoom:3});var a=[JSON.parse(e).longitude,JSON.parse(e).latitude].join();minemap.service.queryReverseGeoCodingResult(a,1,1e3,1e3,0,function(e,a){console.log(a),t.adcode=a.data.adcode,t.province=a.data.dist})},teskManage:function(){this.$router.push({path:"/taskPlan"})},getSiteList:function(){var e=this;this.$post(this.url+"/xhHlck/getXhArea").then(function(t){if(200==t.code)for(var a=JSON.parse(t.data).list,s=0,l=a.length;s<l;s++)e.options.push({value:i()({longitude:a[s].longitude,latitude:a[s].latitude,areaId:a[s].areaId,areaName:a[s].areaName,radius:a[s].radius}),label:a[s].areaName});else e.$message.error("查询失败")})},lowerSure:function(){var e=this;if(this.taskName)if(this.value)if(0!=this.selectedPeople.length){for(var t=[],a=[],s=[],i=[],l=0,n=this.selectedPeople.length;l<n;l++)t.push(this.selectedPeople[l].userId),a.push(this.selectedPeople[l].name),s.push(this.selectedPeople[l].orgId),i.push(this.selectedPeople[l].eName);var r=new URLSearchParams;r.append("taskName",this.taskName),r.append("areaId",JSON.parse(this.value).areaId),r.append("areaName",JSON.parse(this.value).areaName),r.append("latitude",JSON.parse(this.value).latitude),r.append("longitude",JSON.parse(this.value).longitude),r.append("radius",JSON.parse(this.value).radius),r.append("fromUserId",localStorage.getItem("userId")),r.append("fromUserName",localStorage.getItem("userName")),r.append("toUserId",t.join("")),r.append("toUserName",a.join("")),r.append("deptId",s.join("")),r.append("deptName",i.join("")),r.append("zoneCode",this.adcode),r.append("zoneName",this.province),r.append("startTime",this.value3[0]),r.append("endTime",this.value3[1]),r.append("minTargetNum",this.num1),this.$post(this.url+"/xhHlck/addXhTask",r).then(function(t){200==t.code?(e.$message({message:"任务下发成功",type:"success"}),e.$store.commit("TASKSTATUSCODE",{taskStatus:0}),e.$router.push({path:"/taskPlan"})):e.$message.error("创建失败")})}else this.$message({message:"请选择下发人员",type:"warning"});else this.$message({message:"检查地点不能为空",type:"warning"});else this.$message({message:"任务名称不能为空",type:"warning"})},getPeopleList:function(e){var t=this,a=new URLSearchParams;a.append("orgId",e),a.append("pageNum",""),a.append("pageSize",""),this.$post(this.url+"/xhHlckTwo/getSysUser",a).then(function(e){if(200==e.code){JSON.parse(e.data);var a=JSON.parse(e.data).list;0==a.length?t.noData1=!0:t.noData1=!1,t.peopleArr=a}else t.$message.error("新增失败")})},selected:function(e,t,a,s,i){if(this.selectedPeople.some(function(e){if(e.userId==t)return!0}))this.$message({message:"此人在添加列表已存在",type:"warning"});else{this.selectedPeople.push({name:e,userId:t,orgId:a,eName:s});for(var l=0,n=this.peopleArr.length;l<n;l++)this.$refs.active[i].className="active"}},deleteOne:function(e){for(var t=0,a=this.peopleArr.length;t<a;t++)this.peopleArr[t].userId==e&&(this.$refs.active[t].className="");for(t=0,a=this.selectedPeople.length;t<a;t++)if(this.selectedPeople[t].userId==e)return void this.selectedPeople.splice(t,1)},zTreesearchPeople:function(){var e=this;if(this.zTreeinput){var t=new URLSearchParams;t.append("name",this.zTreeinput),this.$post(this.url+"/xhHlckTwo/getSysUser",t).then(function(t){if(200==t.code){var a=JSON.parse(t.data).list;e.peopleArr=a}else e.$message.error("新增失败")})}else this.$message({message:"搜索内容不能为空",type:"warning"})},selecteArea:function(e){this.loadMap(e)},dateTime:function(e){this.value3=e}},components:{zTree:r.a}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lowerTesk"},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"大型安保任务"}},[a("div",{staticClass:"site"},[a("div",{staticClass:"siteSearch"},[a("div",{staticClass:"siteContent"},[a("div",{staticClass:"examineNumber"},[a("p",[e._v("任务名称"),a("em",[e._v("*")])]),e._v(" "),a("el-input",{staticClass:"teskName",attrs:{placeholder:"请输入内容"},model:{value:e.taskName,callback:function(t){e.taskName=t},expression:"taskName"}})],1),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("检查地点"),a("em",[e._v("*")])]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selecteArea},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticStyle:{display:"none"},attrs:{id:"map"}}),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("时间范围"),a("em",[e._v("*")])]),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.dateTime},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("盘查次数"),a("em",[e._v("*")])]),e._v(" "),a("el-input-number",{staticStyle:{width:"220px"},attrs:{min:1,max:1e3,label:"描述文字"},model:{value:e.num1,callback:function(t){e.num1=t},expression:"num1"}})],1),e._v(" "),a("div",{staticClass:"lowerPeople"},[a("p",[e._v("下发人员"),a("em",[e._v("*")])]),e._v(" "),a("div",{staticClass:"lowerDiv"},[a("div",{staticClass:"lowerDivLeft"},[a("div",{staticClass:"search"},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入人员名字"},model:{value:e.zTreeinput,callback:function(t){e.zTreeinput=t},expression:"zTreeinput"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.zTreesearchPeople}},[e._v("搜索")])],1),e._v(" "),a("zTree")],1),e._v(" "),a("ul",{staticClass:"peopleList"},e._l(e.peopleArr,function(t,s){return a("li",{ref:"active",refInFor:!0,class:{active:e.isActive},on:{click:function(a){return e.selected(t.name,t.userId,t.orgId,t.eName,s)}}},[e._v("\n                "+e._s(t.name)+"\n              ")])}),0),e._v(" "),a("div",{staticClass:"lowerDivRight"},[a("p",[e._v("已选择个联系人")]),e._v(" "),a("ul",e._l(e.selectedPeople,function(t){return a("li",[e._v("\n                  "+e._s(t.name)+"\n                  "),a("span",{on:{click:function(a){return e.deleteOne(t.userId)}}},[e._v("×")])])}),0)])])])]),e._v(" "),a("div",{staticClass:"sure"},[a("el-button",{staticClass:"lowerSure",attrs:{type:"primary"},on:{click:e.lowerSure}},[e._v("确定")])],1)])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"路面日常核查"}},[a("div",{staticClass:"site"},[a("div",{staticClass:"siteSearch"},[a("div",{staticClass:"siteContent"},[a("div",{staticClass:"examineNumber"},[a("p",[e._v("任务名称"),a("em",[e._v("*")])]),e._v(" "),a("el-input",{staticClass:"teskName",attrs:{placeholder:"请输入内容"},model:{value:e.taskName,callback:function(t){e.taskName=t},expression:"taskName"}})],1),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("检查地点"),a("em",[e._v("*")])]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selecteArea},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticStyle:{display:"none"},attrs:{id:"map"}}),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("时间范围"),a("em",[e._v("*")])]),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.dateTime},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),e._v(" "),a("div",{staticClass:"examineNumber"},[a("p",[e._v("盘查次数"),a("em",[e._v("*")])]),e._v(" "),a("el-input-number",{staticStyle:{width:"220px"},attrs:{min:1,max:1e3,label:"描述文字"},model:{value:e.num1,callback:function(t){e.num1=t},expression:"num1"}})],1),e._v(" "),a("div",{staticClass:"lowerPeople"},[a("p",[e._v("下发人员"),a("em",[e._v("*")])]),e._v(" "),a("div",{staticClass:"lowerDiv"},[a("div",{staticClass:"lowerDivLeft"},[a("div",{staticClass:"search"},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入人员名字"},model:{value:e.zTreeinput,callback:function(t){e.zTreeinput=t},expression:"zTreeinput"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.zTreesearchPeople}},[e._v("搜索")])],1),e._v(" "),a("zTree")],1),e._v(" "),a("ul",{staticClass:"peopleList"},e._l(e.peopleArr,function(t,s){return a("li",{ref:"active",refInFor:!0,class:{active:e.isActive},on:{click:function(a){return e.selected(t.name,t.userId,t.orgId,t.eName,s)}}},[e._v("\n                "+e._s(t.name)+"\n              ")])}),0),e._v(" "),a("div",{staticClass:"lowerDivRight"},[a("p",[e._v("已选择个联系人")]),e._v(" "),a("ul",e._l(e.selectedPeople,function(t){return a("li",[e._v("\n                  "+e._s(t.name)+"\n                  "),a("span",{on:{click:function(a){return e.deleteOne(t.userId)}}},[e._v("×")])])}),0)])])])]),e._v(" "),a("div",{staticClass:"sure"},[a("el-button",{staticClass:"lowerSure",attrs:{type:"primary"},on:{click:e.lowerSure}},[e._v("确定")])],1)])])])],1)],1)},staticRenderFns:[]};var u=a("VU/8")(c,p,!1,function(e){a("Uk6t")},"data-v-8fac9ece",null);t.default=u.exports},Uk6t:function(e,t){}});