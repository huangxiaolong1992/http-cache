webpackJsonp([6],{X1vq:function(t,e){},jfbr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("4YfN"),i=s.n(a),n=s("2bvH"),c={name:"message-box",props:{codeArray:{type:Array},codeData:{type:Object},isShowConfirm:{type:Boolean}},data:function(){return{sysAppIds:""}},computed:i()({},Object(n.c)({userInfo:function(t){return t.mutations.userInfo}})),created:function(){this.isShowConfirm||this.manageCodeData()},methods:{judgeStatus:function(t){return t-(new Date).getTime()>0},comfirmBtnClicked:function(){this.saveCode()},cancelBtnClicked:function(){this.$emit("cancelBtnClicked",!1)},saveCode:function(){var t=this,e=this.url+this.net.saveCodeAll,s=this.userInfo.id,a={activityId:this.codeData.activityId,startDate:this.codeData.startDate,endDate:this.codeData.endDate,createUser:s,useNumber:this.codeData.useNumber,number:this.codeData.number,codeNames:this.codeData.codeNames};this.$post(e,a).then(function(e){console.log("sucess:",e),200==e.code?(t.$message({message:"保存成功!",type:"success"}),t.$emit("cancelBtnClicked",!1),t.$emit("isSaveCode",!0)):t.$message({message:"数据已存在，禁止重复保存!",type:"warning"})}).catch(function(t){console.log("err:",t)})},manageCodeData:function(){var t=[];this.codeArray.forEach(function(e,s){t.push(e.codeName)}),this.sysAppIds=t.join(" ")},onCopy:function(t){t&&this.$message({message:"复制成功!",type:"success"})},onError:function(t){this.$message.error("复制失败!")}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"fade"}},[s("section",{staticClass:"msg"},[s("div",{staticClass:"msg_wrapper"},[s("div",{staticClass:"msg_musk"}),t._v(" "),s("div",{staticClass:"msg_box box"},[s("header",{staticClass:"box_header"},[s("span",{staticClass:"box_title"},[t._v("微科技")]),t._v(" "),s("i",{staticClass:"box_close el-icon-close",on:{click:t.cancelBtnClicked}})]),t._v(" "),s("div",{staticClass:"box_content"},[s("div",{staticClass:"box_criteria"},[s("div",{staticClass:"criteria_title"},[t._v("\n              配置条件\n            ")]),t._v(" "),s("div",{staticClass:"criteria_content"},["ALL"==t.codeData.activityId?s("p",[t._v("适用活动:不限")]):s("p",[t._v("适用活动:"+t._s(t.codeData.activityName))]),t._v(" "),s("p",[t._v("有效性:"+t._s(t.codeData.useNumber)+"次有效")]),t._v(" "),s("p",[t._v("参赛码有效期:"+t._s(t._f("getdate")(t.codeData.startDate))+"~"+t._s(t._f("getdate")(t.codeData.endDate)))])])]),t._v(" "),s("div",{staticClass:"box_list"},[s("div",{staticClass:"list_title"},[t._v("\n              参赛码列表\n            ")]),t._v(" "),s("div",{staticClass:"list_content"},[t.isShowConfirm?t._e():s("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.sysAppIds,expression:"sysAppIds",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"copy_btn",attrs:{type:"text",size:"medium"}},[t._v("\n                复制全部\n              ")]),t._v(" "),t.isShowConfirm?s("ul",t._l(t.codeData.codeNames,function(e,a){return s("li",{key:a},[s("span",{staticClass:"name"},[t._v("参赛码"+t._s(a+1))]),t._v(t._s(e)+"\n                ")])}),0):s("ul",t._l(t.codeArray,function(e,a){return s("li",{key:a},[s("span",{staticClass:"name"},[t._v("参赛码"+t._s(a+1))]),t._v(t._s(e.codeName)+"\n                  "),0==e.sureUseNumber||0==t.judgeStatus(e.endDate)?s("span",{staticClass:"sign"},[t._v("失效")]):t._e()])}),0)])]),t._v(" "),t.isShowConfirm?s("div",{staticClass:"button"},[s("div",{staticClass:"cancle_btn",on:{click:t.cancelBtnClicked}},[t._v("\n              取消\n            ")]),t._v(" "),s("div",{staticClass:"save_btn",on:{click:t.comfirmBtnClicked}},[t._v("\n              保存\n            ")])]):t._e()])])])])])},staticRenderFns:[]};var l=s("C7Lr")(c,o,!1,function(t){s("X1vq")},"data-v-c9b58bf8",null).exports,r=[{value2:1,label2:"仅一次"},{value2:3,label2:"三次"},{value2:5,label2:"五次"},{value2:10,label2:"十次"},{value2:15,label2:"十五次"}],u={name:"matchAllocation",data:function(){return{isShowMessage:!1,isShowConfirm:!0,inputNums:"",activeOptions:[{activityId:"ALL",activityName:"不限"}],activeValue:"不限",activityId:"ALL",activityName:"不限",effectiveOptions:r,effectiveValue:"仅一次",effectiveTimes:"1",timeValue:"",clearable:!0,codeData:{},codeArray:[],historyCode:[]}},watch:{inputNums:function(t){""==t||this.IsInteger(Number(t))||this.$message({message:"请输入正确的整数值!",type:"warning"})}},computed:i()({},Object(n.c)({userInfo:function(t){return t.mutations.userInfo}})),created:function(){this.getActivityPager(),this.queryHistoryCode()},methods:{IsInteger:function(t){return"number"==typeof t&&t%1==0&&t>0},isSaveCode:function(t){t&&this.queryHistoryCode()},cancelBtnClicked:function(t){this.isShowMessage=t},selectActivity:function(t){var e=this;this.activityName=t,this.activeOptions.find(function(s){s.activityName==t&&(e.activityId=s.activityId)})},selectFrom:function(t){var e=this;this.effectiveValue=t,this.effectiveOptions.find(function(s){s.label2==t&&(e.effectiveTimes=s.value2)})},selectTime:function(t){this.timeValue=t},showCodeInfo:function(){this.isShowMessage=!0,this.isShowConfirm=!0},judgeStatus:function(t,e){var s=(new Date).getTime();return t>s?"未开始":e>s?"生效中":e<s?"已过期":void 0},getActivityPager:function(){var t=this,e=this.url+this.net.queryActivityPager;this.$post(e,{pageNum:1,pageSize:100,orderByParam:"{auditState:1}"}).then(function(e){200==e.code&&null!=e.data.result&&e.data.result.length>0&&e.data.result.forEach(function(e){t.activeOptions.push(e)})}).catch(function(t){console.log("err:",t)})},createCode:function(){var t=this,e=this.url+this.net.createCode,s=this.userInfo.id,a=this.timeValue,i=(new Date).getTime();if(""!=this.activityId)if(""!=this.effectiveTimes)if(""!=this.inputNums)if(a[0])if(a[1]<i)this.$message({message:"截止日期不能小于当前时间",type:"warning"});else{var n={activityId:this.activityId,startDate:a[0],endDate:a[1],activityName:this.activityName,createUser:s,useNumber:this.effectiveTimes,number:this.inputNums};this.$post(e,n).then(function(e){200==e.code&&(t.codeData=e.data,t.showCodeInfo())}).catch(function(t){console.log("err:",t)})}else this.$message({message:"请选择时间",type:"warning"});else this.$message({message:"请填写数量",type:"warning"});else this.$message({message:"请选择有效次数",type:"warning"});else this.$message({message:"请先添加活动",type:"warning"})},queryHistoryCode:function(){var t=this,e=this.url+this.net.queryHistoryCode;this.$post(e,{}).then(function(e){console.log("sucess:",e),200==e.code&&null!=e.data.result&&"null"!=e.data.result&&(t.historyCode=e.data.result)}).catch(function(t){console.log("err:",t)})},getCodeDetail:function(t){var e=this;console.log(t);var s=this.url+this.net.queryHistoryCodeDetails,a={pageNum:1,pageSize:100,createTime:t.createTime};this.$post(s,a).then(function(s){console.log("sucess:",s),200==s.code&&(e.codeData=t,e.codeArray=s.data.result,e.isShowMessage=!0,e.isShowConfirm=!1)}).catch(function(t){console.log("err:",t)})},DeleteItems:function(t){var e=this,s=this.url+this.net.removeCode,a={createTime:t};this.$post(s,a).then(function(s){200==s.code&&1==s.data&&e.historyCode.forEach(function(s,a){s.createTime==t&&(e.historyCode.splice(a,1),e.$message({type:"success",message:"删除成功!"}))})}).catch(function(t){console.log("err:",t)})},showConfimBox:function(t){var e=this;this.$confirm("该组参赛码都将失效，确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.DeleteItems(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}},components:{messageBox:l}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"matchAllocation"},[s("div",{staticClass:"container"},[s("div",{staticClass:"activeTitle"},[t._v("\n        参赛码配置\n      ")]),t._v(" "),s("div",{staticClass:"settingContent"},[s("div",{staticClass:"settingOptions"},[s("div",{staticClass:"title"},[t._v("\n            配置\n          ")]),t._v(" "),s("div",{staticClass:"contents"},[s("div",{staticClass:"requirement"},[s("span",[t._v("\n                通用活动\n                "),s("el-select",{staticClass:"selected",attrs:{clearable:t.clearable,placeholder:"请选择"},on:{change:t.selectActivity},model:{value:t.activeValue,callback:function(e){t.activeValue=e},expression:"activeValue"}},t._l(t.activeOptions,function(t){return s("el-option",{key:t.activityId,attrs:{label:t.activityName,value:t.activityName}})}),1)],1),t._v(" "),s("span",[t._v("\n                有效性\n                "),s("el-select",{staticClass:"selected",attrs:{placeholder:"请选择"},on:{change:t.selectFrom},model:{value:t.effectiveValue,callback:function(e){t.effectiveValue=e},expression:"effectiveValue"}},t._l(t.effectiveOptions,function(t){return s("el-option",{key:t.value2,attrs:{label:t.label2,value:t.label2}})}),1)],1),t._v(" "),s("span",{staticClass:"staticNums"},[t._v("\n                数量\n                "),s("el-input",{attrs:{placeholder:"1~999",maxlength:3},model:{value:t.inputNums,callback:function(e){t.inputNums="string"==typeof e?e.trim():e},expression:"inputNums"}})],1),t._v(" "),s("span",[t._v("\n                有效期\n                "),s("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","value-format":"timestamp","end-placeholder":"结束日期"},on:{change:t.selectTime},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1)]),t._v(" "),s("div",{staticClass:"submitBtn",on:{click:t.createCode}},[t._v("\n              生成\n            ")])])]),t._v(" "),s("div",{staticClass:"settingHistory"},[s("div",{staticClass:"title"},[t._v("\n            历史参赛码\n          ")]),t._v(" "),s("div",{staticClass:"list"},[t.historyCode[0]?t._e():s("div",{staticClass:"noData"},[t._v("\n              暂无数据\n            ")]),t._v(" "),s("ul",{staticClass:"clearfix"},t._l(t.historyCode,function(e,a){return s("li",{key:a,on:{click:function(s){return t.getCodeDetail(e)}}},[s("div",{staticClass:"listNum"},[s("div",{staticClass:"num",class:{commonClass:"已过期"==t.judgeStatus(e.startDate,e.endDate)}},[t._v(t._s(a+1))]),t._v(" "),s("p",{class:{commonClass1:"已过期"==t.judgeStatus(e.startDate,e.endDate)}})]),t._v(" "),s("div",{staticClass:"listText",class:{commonClass2:"已过期"==t.judgeStatus(e.startDate,e.endDate)}},[s("div",{staticClass:"listTextC"},[s("div",{staticClass:"listTextL"},[s("div",{staticClass:"listTitle"},[t._v("\n                        适用活动\n                      ")]),t._v(" "),"ALL"==e.activityId?s("div",{staticClass:"listName"},[t._v("\n                          不限\n                      ")]):s("div",{staticClass:"listName"},[t._v("\n                        "+t._s(e.activityName)+"\n                      ")]),t._v(" "),s("div",{staticClass:"report"},[t._v("\n                        状态\n                      ")]),t._v(" "),s("div",{staticClass:"reportor"},[t._v("\n                        "+t._s(t.judgeStatus(e.startDate,e.endDate))+"\n                      ")]),t._v(" "),s("div",{staticClass:"date"},[t._v("\n                        "+t._s(t._f("getDate")(e.startDate))+"~"+t._s(t._f("getDate")(e.endDate))+"\n                      ")])])])]),t._v(" "),s("div",{staticClass:"closeBtn",on:{click:function(s){return s.stopPropagation(),t.showConfimBox(e.createTime)}}},[s("i",{staticClass:"el-icon-close"})])])}),0)])])])]),t._v(" "),t.isShowMessage?s("messageBox",{attrs:{isShowConfirm:t.isShowConfirm,codeData:t.codeData,codeArray:t.codeArray},on:{cancelBtnClicked:t.cancelBtnClicked,isSaveCode:t.isSaveCode}}):t._e()],1)},staticRenderFns:[]};var v=s("C7Lr")(u,d,!1,function(t){s("oAVv")},"data-v-c9cf5b9c",null);e.default=v.exports},oAVv:function(t,e){}});
//# sourceMappingURL=6.1c130ca71ca2e12c60dd.js.map